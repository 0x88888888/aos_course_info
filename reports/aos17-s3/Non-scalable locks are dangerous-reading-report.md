<h2>– Summary of major innovations</h2>

<p>   
&nbsp;&nbsp;该篇论文主要详述了从之前的实验中得到的非扩展锁具有危险性的结论即不仅性能较差，而且可能导致系统崩溃等问题的出现。三方面的改进如下：
<div>（1）即使在旋转锁正保护内核中一个很短暂的关键部分的情况下，非扩展锁较差的性能可能导致系统整体性能的突然下降；</div>
<div>（2）对于所有机制的非扩展旋转锁的特性，提出了一个不同于之前的具有单一性的综合性模型；</div>
<div>（3）在基于X86的多核处理器中，MCS锁能够在不降低系统性能的前提下改善最大的系统扩展性并且得出不同类型的扩展锁的扩展性和系统性能的提升是很小的。</div>
   在实验中使用一个马尔科夫模型解释了非扩展性自旋锁会导致系统崩溃的严重现象。为了建立排队自旋锁的的准确模型，实验中基于排队理论来模拟排队锁从而作为一条马尔可夫链。马尔科夫链中不同的状态代表等待锁队列中不同的内核数量。实验的模型中共有n+1个状态代表了系统中有固定的n个内核。
</p>

<h2>– What the problems the paper mentioned?</h2>

<p>
&nbsp;&nbsp;非扩展锁是危险的。在多核处理器的实验环境中，采用非扩展锁会导致系统吞吐量的严重下降。尤其是随着相互竞争的核数增加，这时系统的锁开销急剧增大。
&nbsp;&nbsp;随着内核数量的增加会导致突然出现系统性能的严重下降。例如，一个系统在运行N个内核时可能具有很好的测试性能，但是在此基础上再稍微增加一些内核就会使得整体性能的下降。
</p>

<h2>– How about the important related works/papers?</h2>

<p>
&nbsp;&nbsp;Anderson观察到自旋锁的表现性能会下降。很多研究者对于微基准程序总结得出非扩展性的自旋锁在程序竞争状态下的性能表现很差。而这篇文章中实验表明非扩展锁在通常的工作负载状态下可能引起系统的崩溃。

&nbsp;&nbsp;Eyerman和Eeckhout提供了更准确的公式推论关键部分的并行程序，在他们的论文中指出，相比于Amdahl锁预测的准则，在这种机制中运行程序可以获得更好的运行加速度。但是他们的模型在竞争和非竞争机制下做出了区别对待并且为每种运行机制提出了对应的公式。但是，这些准则并非是内部锁机制的模型。
</p>

<h2>– What are some intriguing aspects of the paper?</h2>

<p>
&nbsp;&nbsp;比较新颖的证明方式在于使用一个马尔科夫模型解释了非扩展自旋锁会导致系统崩溃的严重现象。为了建立排队自旋锁的的准确模型，实验中基于排队理论来模拟排队锁而作为一条马尔可夫链。马尔科夫链中不同的状态代表等待锁队列中不同的内核数量。实验的模型中共有n+1个状态代表了系统中有固定的n个内核。不同状态间的到达和服务的速率代表了锁的获取和释放的情形。系统中每一对状态的速率都是不同的来模拟排队锁的非扩展性能。
</p>

<h2>– How to test/compare/analyze the results?</h2>

<p>
&nbsp;&nbsp;使得锁更具扩展性的一个通用的方法是在内核争夺锁的时候应用均衡补偿。另一种方法是用一个真正的扩展锁替换排队锁。扩展锁就是为每次获取产生的缓存缺失生成一个常量并因此避免非扩展锁会产生的系统崩溃等问题。

&nbsp;&nbsp;基于拥有48核的AMD机器上测试ticket锁、proportional锁、MCS锁、K42锁和CLH锁的性能。标准程序使用一个共享锁。每个内核循环地获取共享锁，更新4个共享缓存行再释放锁。对于更新4个共享缓存行的时间，在运行使用不同的锁和逐渐从在2个核上的800个时钟周期到在48个核上的1000个时钟周期。

&nbsp;&nbsp;为了更好的测试MCS锁的性能，该实验基于Linux运行锁的程序。即用MCS锁替换排队锁。首先需要修改1000行Linux内核的代码：在相应的栈上分配一个MCS的qnode，用msc_lock和mcs_unlock分别替换spin_lock和spin_unlock并且向MCS的获取和释放锁的函数传递qnode。

&nbsp;&nbsp;该实验通过FOPS、MEMPOP、PFIND和EXIM基准程序带有MCS锁的性能分析得出使用MCS锁系统的性能至少可以提高3.5倍，在某一情况下可以提高多达16倍。使用MCS锁可以避免非扩展锁可能导致的系统的崩溃。
</p>

<h2>– How can the research be improved?</h2>

<p>
&nbsp;&nbsp;在我看来该论文可以在提高锁的打开和关闭的效率及设计无锁机制方面进一步做出研究。
</p>
