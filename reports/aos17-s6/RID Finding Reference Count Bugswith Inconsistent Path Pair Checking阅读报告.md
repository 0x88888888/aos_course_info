# RID Finding Reference Count Bugswith Inconsistent Path Pair Checking阅读报告



## 1.论文背景

​	引用计数广泛使用于操作系统内核以对资源进行管理。然而，在大型系统中正确使用引用计数是非常重要的，因为一个引用计数的增加与对应的减少是由开发人员来管理的。而这很容易由于人的原因而出错。例如，在操作系统内核的子系统中，其通常用于同步管理、动态内存管理和动态电力管理。对引用计数错误使用会引发各自情况，包括内存资源耗尽、死锁、异常高电力消耗和安全漏洞。

在操作系统内核中，引用计数一般由一个整数封装。然后，只提供API函数用来增加或减少这个整数。
开发人员使用引用计数需要按需操作。
最新统计表明，开发人员对API的理解错误对于大型系统是一个主要威胁。

对于Linux内核，引用计数通常有以下特点：

1. 一个引用通常以加一或减一的方式工作；
2. 通常不关心一个引用的确切值(封装)；
3. 存在一个系统状态，引用计数可能减为0；
4. 引用计数在任何时候都应为非负数。



## 2.设计架构及创新

这篇文章提出了一个非一致性路径对检测(inconsistent path pair checking)机制，用来静态检测OS内核中的引用错误。

一对非一致性路径(简称IPP)由两个路径组成，其满足以下条件：
(1)在同一个函数中(Both paths are in the same function)，
(2)都从一个函数入口开始结束于函数的结尾(Both paths start from the entry of the function and end at the exit)，
(3)对一个引用有不同的修改(The two paths have different changes to a refcount)，
(4)在运行时，函数的参数和返回值相同(at runtime, indistinguishable outside the function by checking arguments and the return value)。



非一致性路径检测不依赖于函数的上下文，而是像库和驱动一样，是操作系统内核的一部分。
并且它对引用计数在函数中的使用不做任何假设，它仅仅需要引用计数的API规格即可。

检测非一致性路径分为三个步骤：

1. 计算所有路径；
2. 总结每个路径的独立性；
3. 检测每个路径的一致性，报告非一致性路径，并将所有结果综合。

基于非一致性路径分析、程序抽象和总结性地过程分析，作者实现了一个静态检测器，叫做RID。



## 3.实验验证

用RID检测Linux内核，实验表明RID对于检测开发者对内核API规格误解和查找引用错误非常有效，并找到了83个被开发者确认的新错误。
用RID检测Python/C程序，检测出100+个错误。